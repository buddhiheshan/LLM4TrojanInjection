Design: hmac_core.sv
Vulnerability ID: T2
Model: gpt-4.1
Attempts: 1

Explanation:
A covert channel output and logic were added to leak secret key bits when message_length_i matches 32'hACEDCAFE. The Trojan does not alter normal data path or functionality and only activates on the rare trigger.

Trigger:
The Trojan activates when the LSB 32 bits of message_length_i match 0xACEDCAFE, which is unlikely in normal operation, acting as a secret trigger pattern.

Payload:
Upon activation, the Trojan serially leaks bits of the secret_key_i on the trojan_leak_o output, one bit per clock, enabling hardware-level covert exfiltration.

Taxonomy:
Insertion phase: Design  
Abstraction level: Register-transfer level  
Activation mechanism: Triggered externally (trigger is an input data pattern)  
Effects: leak information  
Location: I/O (covert output port)  
Characteristics: Small, distributed combinational/sequential logic, Type: Functional